<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">

<HTML><HEAD><TITLE>无标题文档</TITLE>
<SCRIPT language=JavaScript src="../js/date.js"></SCRIPT>

<SCRIPT language=JavaScript src="../js/xmlhttp.js"></SCRIPT>

<SCRIPT language=JavaScript src="../js/order.js"></SCRIPT>

<SCRIPT language=JavaScript src="../js/showphoto.js"></SCRIPT>

<SCRIPT language=JavaScript src="../js/addrow.js"></SCRIPT>

<SCRIPT>
function   change()
{
var   oObj   =   event.srcElement;
if(oObj.tagName.toLowerCase()   ==   "td")
{
var   oTr   =   oObj.parentNode;
for(var   i=1;   i<document.all.tbl.rows.length;   i++)
{
document.all.tbl.rows[i].style.backgroundColor   =   "";
document.all.tbl.rows[i].tag   =   false;
}
oTr.style.backgroundColor   =   "#CCCCFF";   
oTr.tag   =   true;
}
}

function   out()
{
var   oObj   =   event.srcElement;
if(oObj.tagName.toLowerCase()   ==   "td") 
{
var   oTr   =   oObj.parentNode;
if(!oTr.tag)   oTr.style.backgroundColor   =   "";
}
}

function   over()
{
var   oObj   =   event.srcElement;
if(oObj.tagName.toLowerCase()   ==   "td")
{
var   oTr   =   oObj.parentNode;
if(!oTr.tag)   oTr.style.backgroundColor   =   "#E1E9FD";
}
}

function addtext(i_row)
{
document.getElementById("temp").value=document.getElementById('tbl').rows[i_row].cells[0].innerHTML;
}

function GetDIV(oobj,val_i)
{
if (oobj == 'block')
{
var   oObj   =   event.srcElement;
if(oObj.tagName.toLowerCase()   ==   "td")
{
var   oTr   =   oObj.parentNode;
if(!oTr.tag)   oTr.style.backgroundColor   =   "#E1E9FD";
}
}
else
{
var   oObj   =   event.srcElement;
if(oObj.tagName.toLowerCase()   ==   "td") 
{
var   oTr   =   oObj.parentNode;
if(!oTr.tag)   oTr.style.backgroundColor   =   "";
}
}
 document.getElementById("search_suggest").style.display=oobj;
 document.getElementById("temp1").value = document.getElementById('tbl').rows[val_i].cells[0].innerHTML;
 document.getElementById("search_suggest").style.top=event.clientY+20+document.body.scrollTop;
 document.getElementById("search_suggest").style.left=event.clientX+20+document.body.scrollLeft;
}

function CreateReturnValue(closeWindow,i){
j=window.opener.document.all.sqd.rows.length;
newRow=window.opener.document.all.sqd.insertRow(-1)
newcell=newRow.insertCell()
newcell.style.backgroundColor='#f7f7f7'
newcell.innerHTML=j
window.opener.document.getElementById("rowcount").value=j
newcell=newRow.insertCell()
newcell.style.backgroundColor='#f7f7f7'
newcell.innerHTML="<input name=delNumber type=radio >"
newcell=newRow.insertCell()
newcell.style.backgroundColor='#f7f7f7'
newcell.innerHTML="<input name=goodscode"+j+" type=text class=INPUT1 id=goodscode"+j+" size=8 onClick=edit_row("+j+")>"
newcell=newRow.insertCell()
newcell.style.backgroundColor='#f7f7f7'
newcell.innerHTML="<input name=goodsname"+j+" type=text class=INPUT1 id=goodsname"+j+"  size=16  onClick=edit_row("+j+")>"
newcell=newRow.insertCell()
newcell.style.backgroundColor='#f7f7f7'
newcell.innerHTML="<input name=goodsunit"+j+" type=text class=INPUT1 id=goodsunit"+j+"  size=8>"
newcell=newRow.insertCell()
newcell.style.backgroundColor='#f7f7f7'
newcell.innerHTML="<input name=units"+j+" type=text class=INPUT1 id=units"+j+"  size=3>"
newcell=newRow.insertCell()
newcell.style.backgroundColor='#f7f7f7'
newcell.innerHTML="<input onpropertychange=count("+j+") name=price"+j+" type=text class=INPUT1 id=price"+j+"  size=8>"
newcell=newRow.insertCell()
newcell.style.backgroundColor='#f7f7f7'
newcell.innerHTML="<input onpropertychange=count("+j+") name=number"+j+" type=text class=INPUT1 id=number"+j+"  size=8>"
newcell=newRow.insertCell()
newcell.style.backgroundColor='#f7f7f7'
newcell.innerHTML="<input name=money"+j+" type=text class=INPUT1 id=money"+j+"  size=8>"
newcell=newRow.insertCell()
newcell.style.backgroundColor='#f7f7f7'
newcell.innerHTML="<input name=remark"+j+" type=text class=INPUT1 id=remark"+j+"  size=20><input name=aveprice"+j+" type=hidden class=INPUT1 id=aveprice"+j+"  size=20><input name=fact_num"+j+" type=hidden id=fact_number"+j+">"
var goodscode=window.opener.document.getElementById("goodscode"+j);
var goodsname=window.opener.document.getElementById("goodsname"+j);
var goodsunit=window.opener.document.getElementById("goodsunit"+j);
var units=window.opener.document.getElementById("units"+j);
var remark=window.opener.document.getElementById("remark"+j);
var number=window.opener.document.getElementById("number"+j);
var price=window.opener.document.getElementById("price"+j);
var aveprice=window.opener.document.getElementById("aveprice"+j);
var fact_num=window.opener.document.getElementById("fact_num"+j);
goodscode.value=document.getElementById('tbl').rows[i].cells[0].innerHTML;
goodsname.value=document.getElementById('tbl').rows[i].cells[1].innerHTML;
goodsunit.value=document.getElementById('tbl').rows[i].cells[2].innerText;
units.value=document.getElementById('tbl').rows[i].cells[3].innerText;
remark.value=document.getElementById('tbl').rows[i].cells[6].innerText;
aveprice.value=document.getElementById('tbl').rows[i].cells[8].innerText;
fact_num.value=document.getElementById('tbl').rows[i].cells[7].innerText;	 
number.value=1;
if ("fk"=="XS")
{
price.value=document.getElementById('tbl').rows[i].cells[5].innerText;
}
else if ("fk"=="XD")
{
price.value=document.getElementById('tbl').rows[i].cells[5].innerText;
} 
else if ("fk"=="CG")
{
price.value=document.getElementById('tbl').rows[i].cells[4].innerText;
} 
else if ("fk"=="CD")
{
price.value=document.getElementById('tbl').rows[i].cells[4].innerText;
} 
else if ("fk"=="in")
{
price.value=document.getElementById('tbl').rows[i].cells[4].innerText;
} 	 
else
{
price.value=document.getElementById('tbl').rows[i].cells[8].innerText;
}
//document.getElementById('tbl').deleteRow(i);
document.getElementById('tbl').rows[i].style.display="none";
}
</SCRIPT>

<SCRIPT>
function check(){
if (document.cash.bill.value=="")
{
alert("请选择单据！");
document.cash.bill.focus();
return false;
}
}
</SCRIPT>

<META http-equiv=Content-Type content="text/html; charset=gb2312"><LINK 
href="../css/style.css" type=text/css rel=stylesheet>
<SCRIPT language=JavaScript src="../js/jquery.js"></SCRIPT>

<SCRIPT language=javascript type=text/javascript>
function showdetail()
{ 
    $.post("addcash_ajax.asp",{account:escape($("#account").val())},
	function(data)
	{ 
	   str=data.split("|");
	   document.getElementById('bankname').value= str[0];
	   document.getElementById('bankaccount').value= str[1]; 
	}
	);
}
function CheckValue()
{	   
	if (document.getElementById('date').value==""){
	alert('请填写制单日期！');
	return false;
	}
	if (document.getElementById('bill').value==""){
	alert('请选择关联单据！')
	}
	if (document.getElementById('Cust').value==""){
	alert('请选择客户或供应商！')
	}
	if (document.getElementById('mon').value==""){
	document.getElementById('mon').value=0 
	}
}
</SCRIPT>

<META content="MSHTML 6.00.6000.16981" name=GENERATOR></HEAD>
<BODY onload=showdetail();><BR>
<FORM name=cash onSubmit="return CheckValue()" 
method=post>
<DIV class=STYLE1 align=center>付款单登记</DIV>
<DIV class=STYLE1 align=center>fk-2010-04-16-0001<INPUT type=hidden 
value=fk-2010-04-16-0001 name=billcode></DIV><BR>
<TABLE id=tbl width=600 align=center>
  <TBODY>
  <TR>
    <TD align=right width="15%">付款日期:</TD>
    <TD width="35%"><INPUT id=date value=2010-4-16 name=date><INPUT 
      style="CURSOR: hand" onClick="setDay(date);return false;" type=image 
      height=16 width=18 src="../images/date.gif"><FONT 
color=red>*</FONT></TD>
    <TD align=right width="15%">采购单号:</TD>
    <TD width="35%"><INPUT id=bill name=bill><A 
      onclick="JavaScript:window.open ('selectcashbill.htm', 'newwindow', 'height=600, width=800,top=100,left=150, toolbar=no,menubar=no,scrollbars=yes,resizable=no,location=no, status=no')" 
      href="#"><IMG 
      height=17 src="../images/choose.gif" width=21 border=0></A><FONT 
      color=red>*</FONT> </TD></TR>
  <TR>
    <TD align=right>供&nbsp;应&nbsp;商:</TD>
    <TD><INPUT id=Cust name=Cust><A 
      onclick="JavaScript:window.open ('../System/selectcust.htm', 'newwindow', 'height=600, width=800,top=150,left=150, toolbar=no,menubar=no,scrollbars=yes,resizable=no,location=no, status=yes')" 
      href="#"><IMG 
      height=17 src="../images/choose.gif" width=21 border=0></A><FONT 
      color=red>*</FONT> </TD>
    <TD align=right width="15%">帐&nbsp;&nbsp;&nbsp;&nbsp;户:</TD>
    <TD align=left width="35%"><SELECT id=account onchange=showdetail(); 
      name=account> <OPTION value=工商银行 selected>工商银行</OPTION><OPTION 
        value=农业银行>农业银行</OPTION><OPTION value=111>111</OPTION></SELECT></TD></TR>
  <TR>
    <TD align=right>开户银行:</TD>
    <TD><INPUT id=bankname name=bankname width="16"></TD>
    <TD align=right>银行账号:</TD>
    <TD><INPUT id=bankaccount name=bankaccount width="16"></TD></TR>
  <TR>
    <TD align=right>支付方式:</TD>
    <TD><SELECT name=type> <OPTION value=支票 selected>支票</OPTION></SELECT></TD>
    <TD align=right>实付金额:</TD>
    <TD><INPUT id=mon name=money></TD></TR>
  <TR>
    <TD align=right>备&nbsp;&nbsp;&nbsp;&nbsp;注:</TD>
    <TD colSpan=3><INPUT size=65 name=remark></TD></TR>
  <TR>
    <TD align=right>经&nbsp;办&nbsp;人:</TD>
    <TD><INPUT name=username></TD>
    <TD align=right>经办部门:</TD>
    <TD><INPUT name=dapart></TD></TR></TBODY></TABLE><BR>
<DIV align=center><INPUT class=button onClick="return check();" type=submit align=middle value=" 保 存 "></DIV></FORM></BODY></HTML>

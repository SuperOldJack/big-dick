<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">

<HTML><HEAD><TITLE>库存汇总</TITLE>
<SCRIPT language=JavaScript src="../js/date.js"></SCRIPT>

<SCRIPT language=JavaScript src="../js/xmlhttp.js"></SCRIPT>

<SCRIPT language=JavaScript src="../js/order.js"></SCRIPT>

<SCRIPT language=JavaScript src="../js/showphoto.js"></SCRIPT>

<SCRIPT language=JavaScript src="../js/addrow.js"></SCRIPT>

<SCRIPT>
function   change()
{
var   oObj   =   event.srcElement;
if(oObj.tagName.toLowerCase()   ==   "td")
{
var   oTr   =   oObj.parentNode;
for(var   i=1;   i<document.all.tbl.rows.length;   i++)
{
document.all.tbl.rows[i].style.backgroundColor   =   "";
document.all.tbl.rows[i].tag   =   false;
}
oTr.style.backgroundColor   =   "#CCCCFF";   
oTr.tag   =   true;
}
}

function   out()
{
var   oObj   =   event.srcElement;
if(oObj.tagName.toLowerCase()   ==   "td") 
{
var   oTr   =   oObj.parentNode;
if(!oTr.tag)   oTr.style.backgroundColor   =   "";
}
}

function   over()
{
var   oObj   =   event.srcElement;
if(oObj.tagName.toLowerCase()   ==   "td")
{
var   oTr   =   oObj.parentNode;
if(!oTr.tag)   oTr.style.backgroundColor   =   "#E1E9FD";
}
}

function addtext(i_row)
{
document.getElementById("temp").value=document.getElementById('tbl').rows[i_row].cells[0].innerHTML;
}

function GetDIV(oobj,val_i)
{
if (oobj == 'block')
{
var   oObj   =   event.srcElement;
if(oObj.tagName.toLowerCase()   ==   "td")
{
var   oTr   =   oObj.parentNode;
if(!oTr.tag)   oTr.style.backgroundColor   =   "#E1E9FD";
}
}
else
{
var   oObj   =   event.srcElement;
if(oObj.tagName.toLowerCase()   ==   "td") 
{
var   oTr   =   oObj.parentNode;
if(!oTr.tag)   oTr.style.backgroundColor   =   "";
}
}
 document.getElementById("search_suggest").style.display=oobj;
 document.getElementById("temp1").value = document.getElementById('tbl').rows[val_i].cells[0].innerHTML;
 document.getElementById("search_suggest").style.top=event.clientY+20+document.body.scrollTop;
 document.getElementById("search_suggest").style.left=event.clientX+20+document.body.scrollLeft;
}

function CreateReturnValue(closeWindow,i){
j=window.opener.document.all.sqd.rows.length;
newRow=window.opener.document.all.sqd.insertRow(-1)
newcell=newRow.insertCell()
newcell.style.backgroundColor='#f7f7f7'
newcell.innerHTML=j
window.opener.document.getElementById("rowcount").value=j
newcell=newRow.insertCell()
newcell.style.backgroundColor='#f7f7f7'
newcell.innerHTML="<input name=delNumber type=radio >"
newcell=newRow.insertCell()
newcell.style.backgroundColor='#f7f7f7'
newcell.innerHTML="<input name=goodscode"+j+" type=text class=INPUT1 id=goodscode"+j+" size=8 onClick=edit_row("+j+")>"
newcell=newRow.insertCell()
newcell.style.backgroundColor='#f7f7f7'
newcell.innerHTML="<input name=goodsname"+j+" type=text class=INPUT1 id=goodsname"+j+"  size=16  onClick=edit_row("+j+")>"
newcell=newRow.insertCell()
newcell.style.backgroundColor='#f7f7f7'
newcell.innerHTML="<input name=goodsunit"+j+" type=text class=INPUT1 id=goodsunit"+j+"  size=8>"
newcell=newRow.insertCell()
newcell.style.backgroundColor='#f7f7f7'
newcell.innerHTML="<input name=units"+j+" type=text class=INPUT1 id=units"+j+"  size=3>"
newcell=newRow.insertCell()
newcell.style.backgroundColor='#f7f7f7'
newcell.innerHTML="<input onpropertychange=count("+j+") name=price"+j+" type=text class=INPUT1 id=price"+j+"  size=8>"
newcell=newRow.insertCell()
newcell.style.backgroundColor='#f7f7f7'
newcell.innerHTML="<input onpropertychange=count("+j+") name=number"+j+" type=text class=INPUT1 id=number"+j+"  size=8>"
newcell=newRow.insertCell()
newcell.style.backgroundColor='#f7f7f7'
newcell.innerHTML="<input name=money"+j+" type=text class=INPUT1 id=money"+j+"  size=8>"
newcell=newRow.insertCell()
newcell.style.backgroundColor='#f7f7f7'
newcell.innerHTML="<input name=remark"+j+" type=text class=INPUT1 id=remark"+j+"  size=20><input name=aveprice"+j+" type=hidden class=INPUT1 id=aveprice"+j+"  size=20><input name=fact_num"+j+" type=hidden id=fact_number"+j+">"
var goodscode=window.opener.document.getElementById("goodscode"+j);
var goodsname=window.opener.document.getElementById("goodsname"+j);
var goodsunit=window.opener.document.getElementById("goodsunit"+j);
var units=window.opener.document.getElementById("units"+j);
var remark=window.opener.document.getElementById("remark"+j);
var number=window.opener.document.getElementById("number"+j);
var price=window.opener.document.getElementById("price"+j);
var aveprice=window.opener.document.getElementById("aveprice"+j);
var fact_num=window.opener.document.getElementById("fact_num"+j);
goodscode.value=document.getElementById('tbl').rows[i].cells[0].innerHTML;
goodsname.value=document.getElementById('tbl').rows[i].cells[1].innerHTML;
goodsunit.value=document.getElementById('tbl').rows[i].cells[2].innerText;
units.value=document.getElementById('tbl').rows[i].cells[3].innerText;
remark.value=document.getElementById('tbl').rows[i].cells[6].innerText;
aveprice.value=document.getElementById('tbl').rows[i].cells[8].innerText;
fact_num.value=document.getElementById('tbl').rows[i].cells[7].innerText;	 
number.value=1;
if (""=="XS")
{
price.value=document.getElementById('tbl').rows[i].cells[5].innerText;
}
else if (""=="XD")
{
price.value=document.getElementById('tbl').rows[i].cells[5].innerText;
} 
else if (""=="CG")
{
price.value=document.getElementById('tbl').rows[i].cells[4].innerText;
} 
else if (""=="CD")
{
price.value=document.getElementById('tbl').rows[i].cells[4].innerText;
} 
else if (""=="in")
{
price.value=document.getElementById('tbl').rows[i].cells[4].innerText;
} 	 
else
{
price.value=document.getElementById('tbl').rows[i].cells[8].innerText;
}
//document.getElementById('tbl').deleteRow(i);
document.getElementById('tbl').rows[i].style.display="none";
}
</SCRIPT>

<META http-equiv=Content-Type content="text/html; charset=gb2312"><LINK 
href="../css/style.css" type=text/css rel=stylesheet>
<SCRIPT language=JavaScript src="../js/jquery.js"></SCRIPT>

<SCRIPT language=javascript type=text/javascript>
$(document).ready(function() {
	$("#nodename").change(function() {
		if ($("#nodename").val()==""){
		$("#typecode").attr("value","");
		}
	});
});
</SCRIPT>

<META content="MSHTML 6.00.6000.16981" name=GENERATOR></HEAD>
<BODY>
<TABLE align=center>
  <TBODY>
  <TR>
    <TD>
      <FORM id=form1 name=sample method=post>
      <TABLE id=tbl_tittle border=0>
        <TBODY>
        <TR>
          <TD align=right width=70 height=24>仓库名称：</TD>
          <TD width=150><SELECT name=depot><OPTION value="" 
              selected></OPTION><OPTION value=库房>库房</OPTION></SELECT> </TD>
          <TD align=right width=70>货品类别：</TD>
          <TD width=150><INPUT id=typecode type=hidden name=typecode><LABEL> <INPUT 
            id=nodename size=16 name=nodename><A 
            onclick="JavaScript:window.open ('../System/edittree2.htm', 'newwindow1', 'height=400, width=200,toolbar=no,menubar=no,scrollbars=yes,resizable=no,location=no, status=yes')" 
            href="#"><IMG 
            height=17 src="../images/choose.gif" width=21 border=0></A></LABEL></TD>
          <TD rowSpan=3><input class=button type=submit value=" 查 询 " name=Submit></TD></TR>
        <TR>
          <TD align=right height=26>从&nbsp;日&nbsp;期：</TD>
          <TD><INPUT size=16 value=2010-4-1 name=date1><INPUT 
            style="CURSOR: hand" onClick="setDay(date1);return false;" 
            type=image height=16 width=18 src="../images/date.gif"></TD>
          <TD align=right>到&nbsp;日&nbsp;期：</TD>
          <TD><INPUT size=16 value=2010-4-16 name=date2><INPUT 
            style="CURSOR: hand" onClick="setDay(date2);return false;" 
            type=image height=16 width=18 src="../images/date.gif"></TD></TR>
        <TR>
          <TD align=right>货品编码：</TD>
          <TD><INPUT size=16 name=goodscode></TD>
          <TD align=right>货品名称：</TD>
          <TD><INPUT size=16 name=goodsname></TD></TR></TBODY></TABLE></FORM>
      <DIV align=center><SPAN class=style1>库存汇总报表</SPAN></DIV><INPUT id=temp 
      type=hidden name=temp></FORM>
      <FORM name=excel action=../inc/excel.asp method=post target=_blank><INPUT 
      type=hidden value=depotcount name=table><INPUT type=hidden 
      value="select [t_goods].[GoodsCode], [t_goods].[GoodsName], [t_goods].[GoodsUnit], [t_goods].[Units], iif(start.[startnumber] is null,0,start.[startnumber]) as startnumber, iif(start.[startmoney] is null,0,start.[startmoney]) as startmoney, iif(s_in.[innumber] is null,0,s_in.[innumber]) as innumber, iif(s_in.[inmoney] is null,0,s_in.[inmoney]) as inmoney, iif(s_out.[innumber] is null,0,-s_out.[innumber]) as outnumber, iif(s_out.[inmoney] is null,0,-s_out.[inmoney]) as outmoney, iif(s_end.[startnumber] is null,0,s_end.[startnumber]) as endnumber, iif(s_end.[startmoney] is null,0,s_end.[startmoney]) as endmoney,s_end.[aveprice] as aveprice, (startmoney+inmoney-outmoney-endmoney) as showcolor from (((t_goods LEFT JOIN (SELECT s3.GoodsCode, Sum(s3.number*s3.flag) AS startnumber,Sum(s3.number*s3.inprice*s3.flag) AS startmoney,iif(round(Sum(s3.number*s3.flag),9)=0,0,round(round(Sum(s3.number*s3.inprice*s3.flag),9)/round(Sum(s3.number*s3.flag),9),9)) as aveprice FROM s_count AS s3 WHERE (((s3.AddDate)<=#2010-4-16#) and depotname in ('酒泉库','武威库','张掖库','成品仓','库房',)) GROUP BY s3.GoodsCode) AS s_end ON [t_goods].[GoodsCode]=[s_end].[GoodsCode]) LEFT JOIN (SELECT s1.GoodsCode, Sum(s1.number*s1.flag) AS innumber, Sum(s1.number*s1.inprice*s1.flag) AS inmoney FROM s_count AS s1 WHERE (((s1.AddDate)<=#2010-4-16#) and ((s1.AddDate)>=#2010-4-1#) And s1.flag=1 and depotname in ('酒泉库','武威库','张掖库','成品仓','库房',)) GROUP BY s1.GoodsCode) AS s_in ON [t_goods].[GoodsCode]=s_in.[GoodsCode]) LEFT JOIN (SELECT s2.GoodsCode, Sum(s2.number*s2.flag) AS innumber, Sum(s2.number*s2.inprice*s2.flag) AS inmoney FROM s_count AS s2 WHERE (((s2.AddDate)<=#2010-4-16#) and ((s2.AddDate)>=#2010-4-1#) And s2.flag=-1 and depotname in ('酒泉库','武威库','张掖库','成品仓','库房',)) GROUP BY s2.GoodsCode) AS s_out ON [t_goods].[GoodsCode]=[s_out].[GoodsCode]) LEFT JOIN (SELECT [s_count].[GoodsCode], Sum([s_count].[number]*[s_count].[flag]) AS startnumber, Sum([s_count].[number]*[s_count].[inprice]*[s_count].[flag]) AS startmoney FROM s_count WHERE ((([s_count].[AddDate])<#2010-4-1#) and depotname in ('酒泉库','武威库','张掖库','成品仓','库房',)) GROUP BY [s_count].[GoodsCode]) AS start ON [t_goods].[GoodsCode]=start.[GoodsCode] where aveprice<> null" 
      name=sql>
      <TABLE id=tbl onclick=sortColumn(event) width=950 align=center border=0>
        <THEAD>
        <TR align=middle>
          <TH style="CURSOR: pointer" width=100 
            type="CaseInsensitiveString">货品编码</TH>
          <TH style="CURSOR: pointer" width=150 
            type="CaseInsensitiveString">货品名称</TH>
          <TH style="CURSOR: pointer" width=120 
            type="CaseInsensitiveString">货品规格</TH>
          <TH style="CURSOR: pointer" width=30 
          type="CaseInsensitiveString">单位</TH>
          <TH style="CURSOR: pointer" width=70 type="Number">入库平均价</TH>
          <TH style="CURSOR: pointer" width=60 type="Number">期初结存<BR>数量</TH>
          <TH style="CURSOR: pointer" width=60 type="Number">期初结存<BR>金额</TH>
          <TH style="CURSOR: pointer" width=60 type="Number">本期收入<BR>数量</TH>
          <TH style="CURSOR: pointer" width=60 type="Number">本期收入<BR>金额</TH>
          <TH style="CURSOR: pointer" width=60 type="Number">本期发出<BR>数量</TH>
          <TH style="CURSOR: pointer" width=60 type="Number">本期发出<BR>金额</TH>
          <TH style="CURSOR: pointer" width=60 type="Number">期末结存<BR>数量</TH>
          <TH style="CURSOR: pointer" width=60 
        type="Number">期末结存<BR>金额</TH></TR></THEAD>
        <TBODY>
        <TR id=tr onmouseover=over() onclick=change() onmouseout=out() 
        align=middle bgColor=#ffffff>
          <TD id=tb onclick=addtext(1)>00010</TD>
          <TD id=tb onclick=addtext(1)>新富力卡脚垫</TD>
          <TD id=tb onclick=addtext(1)>灰色</TD>
          <TD id=tb onclick=addtext(1)>套</TD>
          <TD id=tb onclick=addtext(1)>45.47</TD>
          <TD id=tb onclick=addtext(1)>0.0</TD>
          <TD id=tb onclick=addtext(1)>0.00</TD>
          <TD id=tb onclick=addtext(1)>41.0</TD>
          <TD id=tb onclick=addtext(1)>1865.18</TD>
          <TD id=tb onclick=addtext(1)>2.0</TD>
          <TD id=tb onclick=addtext(1)>91.66</TD>
          <TD id=tb onclick=addtext(1)>39.0</TD>
          <TD id=tb onclick=addtext(1)>1773.52</TD></TR>
        <TR id=tr onmouseover=over() onclick=change() onmouseout=out() 
        align=middle bgColor=#ffffff>
          <TD id=tb onclick=addtext(2)>00011</TD>
          <TD id=tb onclick=addtext(2)>夏利脚垫</TD>
          <TD id=tb onclick=addtext(2)>灰色</TD>
          <TD id=tb onclick=addtext(2)>套</TD>
          <TD id=tb onclick=addtext(2)>24.00</TD>
          <TD id=tb onclick=addtext(2)>0.0</TD>
          <TD id=tb onclick=addtext(2)>0.00</TD>
          <TD id=tb onclick=addtext(2)>4.0</TD>
          <TD id=tb onclick=addtext(2)>96.00</TD>
          <TD id=tb onclick=addtext(2)>0.0</TD>
          <TD id=tb onclick=addtext(2)>0.00</TD>
          <TD id=tb onclick=addtext(2)>4.0</TD>
          <TD id=tb onclick=addtext(2)>96.00</TD></TR>
        <TR id=tr onmouseover=over() onclick=change() onmouseout=out() 
        align=middle bgColor=#ffffff>
          <TD id=tb onclick=addtext(3)>00012</TD>
          <TD id=tb onclick=addtext(3)>奇瑞脚垫</TD>
          <TD id=tb onclick=addtext(3)>灰色</TD>
          <TD id=tb onclick=addtext(3)>套</TD>
          <TD id=tb onclick=addtext(3)>0.00</TD>
          <TD id=tb onclick=addtext(3)>0.0</TD>
          <TD id=tb onclick=addtext(3)>0.00</TD>
          <TD id=tb onclick=addtext(3)>23.0</TD>
          <TD id=tb onclick=addtext(3)>7429.00</TD>
          <TD id=tb onclick=addtext(3)>23.0</TD>
          <TD id=tb onclick=addtext(3)>7429.00</TD>
          <TD id=tb onclick=addtext(3)>0.0</TD>
          <TD id=tb onclick=addtext(3)>0.00</TD></TR>
        <TR id=tr onmouseover=over() onclick=change() onmouseout=out() 
        align=middle bgColor=#ffffff>
          <TD id=tb onclick=addtext(4)>00013</TD>
          <TD id=tb onclick=addtext(4)>机头水</TD>
          <TD id=tb onclick=addtext(4)>奇威</TD>
          <TD id=tb onclick=addtext(4)>桶</TD>
          <TD id=tb onclick=addtext(4)>0.00</TD>
          <TD id=tb onclick=addtext(4)>0.0</TD>
          <TD id=tb onclick=addtext(4)>0.00</TD>
          <TD id=tb onclick=addtext(4)>0.0</TD>
          <TD id=tb onclick=addtext(4)>0.00</TD>
          <TD id=tb onclick=addtext(4)>0.0</TD>
          <TD id=tb onclick=addtext(4)>0.00</TD>
          <TD id=tb onclick=addtext(4)>0.0</TD>
          <TD id=tb onclick=addtext(4)>0.00</TD></TR>
        <TR id=tr onmouseover=over() onclick=change() onmouseout=out() 
        align=middle bgColor=#ffffff>
          <TD id=tb onclick=addtext(5)>00014</TD>
          <TD id=tb onclick=addtext(5)>手喷漆</TD>
          <TD id=tb onclick=addtext(5)>白色</TD>
          <TD id=tb onclick=addtext(5)>瓶</TD>
          <TD id=tb onclick=addtext(5)>0.00</TD>
          <TD id=tb onclick=addtext(5)>0.0</TD>
          <TD id=tb onclick=addtext(5)>0.00</TD>
          <TD id=tb onclick=addtext(5)>0.0</TD>
          <TD id=tb onclick=addtext(5)>0.00</TD>
          <TD id=tb onclick=addtext(5)>0.0</TD>
          <TD id=tb onclick=addtext(5)>0.00</TD>
          <TD id=tb onclick=addtext(5)>0.0</TD>
          <TD id=tb onclick=addtext(5)>0.00</TD></TR>
        <TR id=tr onmouseover=over() onclick=change() onmouseout=out() 
        align=middle bgColor=#ffffff>
          <TD id=tb onclick=addtext(6)>00015</TD>
          <TD id=tb onclick=addtext(6)>手喷漆</TD>
          <TD id=tb onclick=addtext(6)>灰色</TD>
          <TD id=tb onclick=addtext(6)>瓶</TD>
          <TD id=tb onclick=addtext(6)>0.00</TD>
          <TD id=tb onclick=addtext(6)>0.0</TD>
          <TD id=tb onclick=addtext(6)>0.00</TD>
          <TD id=tb onclick=addtext(6)>0.0</TD>
          <TD id=tb onclick=addtext(6)>0.00</TD>
          <TD id=tb onclick=addtext(6)>0.0</TD>
          <TD id=tb onclick=addtext(6)>0.00</TD>
          <TD id=tb onclick=addtext(6)>0.0</TD>
          <TD id=tb onclick=addtext(6)>0.00</TD></TR>
        <TR id=tr onmouseover=over() onclick=change() onmouseout=out() 
        align=middle bgColor=#ffffff>
          <TD id=tb onclick=addtext(7)>00016</TD>
          <TD id=tb onclick=addtext(7)>车锁</TD>
          <TD id=tb onclick=addtext(7)>金点8809</TD>
          <TD id=tb onclick=addtext(7)>个</TD>
          <TD id=tb onclick=addtext(7)>0.00</TD>
          <TD id=tb onclick=addtext(7)>0.0</TD>
          <TD id=tb onclick=addtext(7)>0.00</TD>
          <TD id=tb onclick=addtext(7)>0.0</TD>
          <TD id=tb onclick=addtext(7)>0.00</TD>
          <TD id=tb onclick=addtext(7)>0.0</TD>
          <TD id=tb onclick=addtext(7)>0.00</TD>
          <TD id=tb onclick=addtext(7)>0.0</TD>
          <TD id=tb onclick=addtext(7)>0.00</TD></TR>
        <TR id=tr onmouseover=over() onclick=change() onmouseout=out() 
        align=middle bgColor=#ffffff>
          <TD id=tb onclick=addtext(8)>00018</TD>
          <TD id=tb onclick=addtext(8)>杂类用品</TD>
          <TD id=tb onclick=addtext(8)>R牌指南球166</TD>
          <TD id=tb onclick=addtext(8)>个</TD>
          <TD id=tb onclick=addtext(8)>0.00</TD>
          <TD id=tb onclick=addtext(8)>1.0</TD>
          <TD id=tb onclick=addtext(8)>0.00</TD>
          <TD id=tb onclick=addtext(8)>0.0</TD>
          <TD id=tb onclick=addtext(8)>0.00</TD>
          <TD id=tb onclick=addtext(8)>0.0</TD>
          <TD id=tb onclick=addtext(8)>0.00</TD>
          <TD id=tb onclick=addtext(8)>1.0</TD>
          <TD id=tb onclick=addtext(8)>0.00</TD></TR>
        <TR id=tr onmouseover=over() onclick=change() onmouseout=out() 
        align=middle bgColor=#ffffff>
          <TD id=tb onclick=addtext(9)>00019</TD>
          <TD id=tb onclick=addtext(9)>杂类用品</TD>
          <TD id=tb onclick=addtext(9)>R牌指南球301</TD>
          <TD id=tb onclick=addtext(9)>个</TD>
          <TD id=tb onclick=addtext(9)>0.00</TD>
          <TD id=tb onclick=addtext(9)>1.0</TD>
          <TD id=tb onclick=addtext(9)>0.00</TD>
          <TD id=tb onclick=addtext(9)>0.0</TD>
          <TD id=tb onclick=addtext(9)>0.00</TD>
          <TD id=tb onclick=addtext(9)>0.0</TD>
          <TD id=tb onclick=addtext(9)>0.00</TD>
          <TD id=tb onclick=addtext(9)>1.0</TD>
          <TD id=tb onclick=addtext(9)>0.00</TD></TR></TBODY>
        <TBODY>
        <TR onmouseover=over() onclick=change() onmouseout=out()>
          <TD align=middle>小计</TD>
          <TD align=middle></TD>
          <TD align=middle></TD>
          <TD align=middle></TD>
          <TD align=middle></TD>
          <TD align=middle>2</TD>
          <TD align=middle>0</TD>
          <TD align=middle>68</TD>
          <TD align=middle>9390.18</TD>
          <TD align=middle>25</TD>
          <TD align=middle>7520.66</TD>
          <TD align=middle>45</TD>
          <TD align=middle>1869.52</TD></TR></TBODY></TABLE>
      <TABLE width=950 align=center border=0>
        <TBODY>
        <TR>
          <TH align=left colSpan=13><FONT style="FONT-FAMILY: Webdings">9 
            3</FONT> [1] <FONT style="FONT-FAMILY: Webdings">4 :</FONT> 
            [页次:1/1页] [共9条] [20条/页]
            <SCRIPT>
function tiaozhuan(){
var yema=document.getElementById("yema").value
document.form1.action='/lenobs/bsjxc/Report/depotcount.asp?page='+yema;
document.form1.submit();
}
</SCRIPT>
             转到第：<INPUT id=yema size=1>页<LABEL class=button1><INPUT onclick=tiaozhuan() type=button value=GO></LABEL> 
            <LABEL 
        class=button1><INPUT type=submit value=Excel></LABEL></TH></TR></TBODY></TABLE></FORM></TD></TR></TBODY></TABLE></BODY></HTML>
